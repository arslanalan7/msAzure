#Create a route table and custom route
#In the Cloud Shell window on the right side of the screen, select the More icon (...), then select Settings > Go to Classic version.
az network route-table create \
        --name publictable \
        --resource-group "learn-d67dac1d-4c26-4428-b030-99e28b6bd57b" \
        --disable-bgp-route-propagation false

#create a custom route:
az network route-table route create \
        --route-table-name publictable \
        --resource-group "learn-d67dac1d-4c26-4428-b030-99e28b6bd57b" \
        --name productionsubnet \
        --address-prefix 10.0.1.0/24 \
        --next-hop-type VirtualAppliance \
        --next-hop-ip-address 10.0.2.4

#Create a virtual network and subnets
#Run the following command to create the vnet virtual network and the publicsubnet subnet:
az network vnet create \
        --name vnet \
        --resource-group "learn-d67dac1d-4c26-4428-b030-99e28b6bd57b" \
        --address-prefixes 10.0.0.0/16 \
        --subnet-name publicsubnet \
        --subnet-prefixes 10.0.0.0/24

#Run the following command in Cloud Shell to create the privatesubnet subnet:
az network vnet subnet create \
        --name privatesubnet \
        --vnet-name vnet \
        --resource-group "learn-d67dac1d-4c26-4428-b030-99e28b6bd57b" \
        --address-prefixes 10.0.1.0/24

#Run the following command to create the dmzsubnet subnet:
az network vnet subnet create \
        --name dmzsubnet \
        --vnet-name vnet \
        --resource-group "learn-d67dac1d-4c26-4428-b030-99e28b6bd57b" \
        --address-prefixes 10.0.2.0/24

#You should now have three subnets. Run the following command to show all of the subnets in the vnet virtual network:
az network vnet subnet list \
        --resource-group "learn-d67dac1d-4c26-4428-b030-99e28b6bd57b" \
        --vnet-name vnet \
        --output table

#Associate the route table with the public subnet
az network vnet subnet update \
        --name publicsubnet \
        --vnet-name vnet \
        --resource-group "learn-d67dac1d-4c26-4428-b030-99e28b6bd57b" \
        --route-table publictable
